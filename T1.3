import React, { useState, useContext, useMemo } from 'react';

const MyContext = React.createContext();

const Provider = ({ children }) => {
  const [count, setCount] = useState(0);

  // Memoize context value so it only changes when `count` changes
  const value = useMemo(() => ({
    count,
    increment: () => setCount(c => c + 1),
  }), [count]);

  console.log('Provider rendered');

  return <MyContext.Provider value={value}>{children}</MyContext.Provider>;
};

const ConsumerComponent = React.memo(() => {
  const { count, increment } = useContext(MyContext);

  console.log('Consumer rendered');

  return (
    <div>
      <p>Count: {count}</p>
      <button onClick={increment}>Add</button>
    </div>
  );
});


export default function App() {
  return (
    <Provider>
      <ConsumerComponent />
    </Provider>
  );
}
